Description: qga: check bytes count read by guest-file-read
 While reading file content via 'guest-file-read' command,
 'qmp_guest_file_read' routine allocates buffer of count+1
 bytes. It could overflow for large values of 'count'.
 .
 Add check to avoid it.
 .
 qga/commands-win32.c: not considered in this backport since
 'qmp_guest_file_read' was not supported at that time.
Author: Prasad J Pandit <pjp@fedoraproject.org>
Origin: upstream, https://git.qemu.org/?p=qemu.git;a=commit;h=141b197408ab398c4f474ac1a728ab316e921f2b
--- a/qga/commands-posix.c	2014-08-01 16:12:17.000000000 +0200
+++ b/qga/commands-posix.c	2019-02-27 08:57:56.743852822 +0100
@@ -451,7 +451,7 @@
 
     if (!has_count) {
         count = QGA_READ_COUNT_DEFAULT;
-    } else if (count < 0) {
+    } else if (count < 0 || count >= UINT32_MAX) {
         error_setg(errp, "value '%" PRId64 "' is invalid for argument count",
                    count);
         return NULL;
