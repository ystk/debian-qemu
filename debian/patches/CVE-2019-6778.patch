Description: slirp: check data length while emulating ident function
 While emulating identification protocol, tcp_emu() does not check
 available space in the 'sc_rcv->sb_data' buffer. It could lead to
 heap buffer overflow issue. Add check to avoid it.
Author: Prasad J Pandit <pjp@fedoraproject.org>
Origin: upstream, https://git.qemu.org/?p=qemu.git;a=commit;h=a7104eda7dab99d0cdbd3595c211864cba415905
--- a/slirp/tcp_subr.c	2014-08-01 16:12:17.000000000 +0200
+++ b/slirp/tcp_subr.c	2019-02-26 10:05:02.207716483 +0100
@@ -581,6 +581,11 @@
 			socklen_t addrlen = sizeof(struct sockaddr_in);
 			struct sbuf *so_rcv = &so->so_rcv;
 
+			if (m->m_len > so_rcv->sb_datalen
+                                        - (so_rcv->sb_wptr - so_rcv->sb_data)) {
+                            return 1;
+			}
+
 			memcpy(so_rcv->sb_wptr, m->m_data, m->m_len);
 			so_rcv->sb_wptr += m->m_len;
 			so_rcv->sb_rptr += m->m_len;
